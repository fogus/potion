{"version":1,"ops":[{"type":1,"author":{"id":"dc8a501266912e06a2fdd3f9cafe05d1338b8aad"},"timestamp":1416471353,"metadata":{"github-id":"MDU6SXNzdWU0OTUwOTI4Mw==","github-url":"https://github.com/perl11/potion/issues/76","origin":"github"},"title":"numeric compare in wrong integer context","message":"`potion -e'x = 0.01 \u003e 4, x print'`\n=\u003e `true`\n\nbecause the registers are compared in integer context.\n\nwe need to check the numeric type like this (dynamic version):\n\n```\n#define PN_VM_NUMCMP(cmp)                     \\\n  if (PN_IS_NUM(reg[op.a]) \u0026\u0026 PN_IS_NUM(reg[op.b])        \\\n    reg[op.a] = PN_BOOL(reg[op.a] cmp reg[op.b]);         \\\n  else                                    \\\n    reg[op.a] = PN_BOOL(PN_DBL(reg[op.a]) cmp PN_DBL(reg[op.b])); \\\n```","files":null}]}